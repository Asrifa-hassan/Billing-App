{% extends 'navbar.html' %}
{% load static %}
{% block title %}Staff{% endblock %}

{% block link %}
<link rel="stylesheet" href="{% static 'css/product.css' %}">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css">

<style>
  .page-col {
    background-color: #f9f9f9;
    border-radius: 12px;
    padding: 10px;
    margin-top: 0;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
  }

  .search-input {
    border-radius: 8px;
    border: 1px solid #ccc;
    padding: 8px 12px;
    font-size: 14px;
    width: 100%;
  }

  .btn-add-product {
    background-color: blue;
    color: #fff;
    border-radius: 8px;
    padding: 8px 16px;
    font-weight: 500;
    border:none;
  }

  .btn-product,
  .btn-add-product:hover {
    background-color: #566d85;
      border: none;
  }

  .table {
    font-size: 14px;
    background-color: #fff;
    border-radius: 8px;
  }

  .table th, .table td {
    vertical-align: middle;
    padding: 12px;
    white-space: nowrap;
  }

  .text-box {
    background-color: #fff3cd;
    border: 1px solid #ffeeba;
    border-radius: 8px;
    color: #856404;
  }

  .switch-with-text {
    position: relative;
    display: inline-block;
    width: 90px;
    height: 36px;
  }

  .switch-with-text input {
    opacity: 0;
    width: 0;
    height: 0;
  }

  .slider-text {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: -4px;
    bottom: 0;
    background-color: #e74c3c;
    transition: background-color 0.4s ease;
    border-radius: 50px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-weight: 600;
    font-size: 12px;
    padding: 0 10px;
  }

  .slider-text:before {
    content: "";
    position: absolute;
    height: 24px;
    width: 24px;
    left: 6px;
    bottom: 6px;
    background-color: white;
    transition: transform 0.4s ease;
    border-radius: 50%;
    z-index: 1;
  }

  .toggle-label {
    position: absolute;
    z-index: 2;
    transition: opacity 0.3s ease;
    font-size: 9px;
    letter-spacing: 0.5px;
  }

  .toggle-label.on {
    left: 45%;
    transform: translateX(-50%);
    opacity: 0;
  }

  .toggle-label.off {
    left: 58%;
    transform: translateX(-50%);
    opacity: 1;
  }

  input:checked + .slider-text {
    background-color: #2ecc71;
  }

  input:checked + .slider-text:before {
    transform: translateX(60px);
  }

  input:checked + .slider-text .on {
    opacity: 1;
  }

  input:checked + .slider-text .off {
    opacity: 0;
  }

  @media (max-width: 768px) {
    .form-group.col-lg-9,
    .form-group.col-lg-3 {
      width: 100%;
      margin-bottom: 10px;
    }

    .table-responsive {
      overflow-x: auto;
    }

    .btn {
      width: 100%;
    }
  }
</style>
{% endblock %}

{% block content %}
<div class="col-lg-10 col-md-9 col-sm-12 page-col">
  <h2 class="p-4">ðŸ‘¤ Staff Details</h2>

  <form action="{% url 'staff' %}" method="get" class="row g-3 px-4">
    {% csrf_token %}
    <div class="col-12 col-md-5">
      <input type="text" class="form-control search-input" name="search" placeholder="ðŸ” Search staff..." autocomplete="off">
    </div>
    <div class="col-12 col-md-4">
      <input type="date" name="date" class="form-control">
      <small class="text-muted">Login/Join Date</small>
    </div>
    <div class="col-12 col-md-3">
      <button type="submit" class="btn btn-success w-100" style="background-color: #1d4876;">Search</button>
    </div>
  </form>

  <div class="d-flex justify-content-end p-4">
    <a href="{% url 'add_staff' %}" class="btn btn-primary btn-add-product">Add Staff</a>
  </div>

  {% if users %}
  <div class="table-div table-responsive px-4">
    <table class="table table-hover table-bordered">
      <thead>
        <tr>
          <th>#</th>
          <th>First</th>
          <th>Last</th>
          <th>Email</th>
          <th>Joined</th>
          <th>Last Login</th>
          <th>Staff</th>
          <th colspan="2">Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for user in users %}
        <tr>
          <td>{{ forloop.counter }}</td>
          <td>{{ user.first_name }}</td>
          <td>{{ user.last_name }}</td>
          <td>{{ user.email }}</td>
          <td>{{ user.date_joined }}</td>
          <td>{{ user.last_login }}</td>
          <td>
            <form method="post" action="{% url 'activate_staff' user.id %}">
              {% csrf_token %}
              <label class="switch-with-text">
                <input type="checkbox" onchange="this.form.submit()" {% if user.is_staff %}checked{% endif %}>
                <span class="slider-text">
                  <span class="toggle-label on">Staff</span>
                  <span class="toggle-label off">NoStaff</span>
                </span>
              </label>
            </form>
          </td>
          <td>
            <div class="dropdown">
              <button class="btn btn-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown">
                Actions
              </button>
              <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="{% url 'view_staff' user.id %}">View</a></li>
                <li><a class="dropdown-item" href="{% url 'update_staff' user.id %}">Edit</a></li>
                <li><a class="dropdown-item" href="{% url 'delete_staff' user.id %}" onclick="return confirm('Are you sure you want to delete this staff?');">Delete</a></li>
              </ul>
            </div>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  {% else %}
  <div class="text-center text-box p-4 mx-4">
    <h4>No user found!</h4>
  </div>
  {% endif %}
</div>
{% endblock %}
