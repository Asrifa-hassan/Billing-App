{% extends 'navbar.html' %}
{% load static %}
{% block title %}Staff{% endblock %}
{% block link %}
<link rel="stylesheet" href="{% static 'css/product.css' %}">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css">
<style>
  .page-col {
    background-color: #f9f9f9;
    border-radius: 12px;
    padding: 10px;
    margin-top: 0 ;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
  }
  .search-input {
    border-radius: 8px;
    border: 1px solid #ccc;
    padding: 8px 12px;
    font-size: 14px;
  }

  .btn-add-product {
    background-color:blue;
    color: #fff;
    border-radius: 8px;
    padding: 8px 16px;
    font-weight: 500;
  }

  .btn-add-product:hover {
    background-color: #566d85;
  }

  .btn-product {
    background-color: #1d4876;
    color: white;
    border-radius: 8px;
    padding: 8px 14px;
  }

  .btn-product:hover {
    background-color: #566d85;
  }

  .table-div {
    margin-top: 20px;
    height: auto;
  }

  .table {
    font-size: 14px;
    background-color: #fff;
    border-radius: 8px;
    overflow: hidden;
  }

  .table thead {
    background-color: #f0f0f0;
    font-weight: 600;
  }

  .table th,
  .table td {
    vertical-align: middle;
    padding: 12px;
  }

  .table-hover tbody tr:hover {
    background-color: #f8f9fa;
  }

  .btn-success,
  .btn-danger {
    padding: 4px 10px;
    font-size: 13px;
    border-radius: 6px;
  }

  .text-box {
    background-color: #fff3cd;
    border: 1px solid #ffeeba;
    border-radius: 8px;
    color: #856404;
  }
  .row{
    height: 75px !important;
    width: 100%;
  }
  .visually-hidden {
    position: absolute;
    width: 1px;
    height: 1px;
    margin: -1px;
    padding: 0;
    overflow: hidden;
    clip: rect(0 0 0 0);
    border: 0;
  }
  .dropdown-menu{
    position: absolute;
    inset: -10px auto auto 0;
    margin: 0;
    transform: translate3d(-52px, 39.3333px, 0px);
  }
  .switch-with-text {
    position: relative;
    display: inline-block;
    width: 90px;
    height: 36px;
  }
  .switch-with-text input {
    opacity: 0;
    width: 0;
    height: 0;
  }
  .slider-text {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: -4px;
    bottom: 0;
    background-color: #e74c3c; /* Not Staff */
    transition: background-color 0.4s ease;
    border-radius: 50px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-weight: 600;
    font-size: 12px; /* Adjusted size */
    text-transform: uppercase;
    padding: 0 10px;
  }
  .slider-text:before {
    content: "";
    position: absolute;
    height: 24px;
    width: 24px;
    left: 6px;
    bottom: 6px;
    background-color: white;
    transition: transform 0.4s ease;
    border-radius: 50%;
    z-index: 1;
  }
  .toggle-label {
    position: absolute;
    z-index: 2;
    transition: opacity 0.3s ease;
    font-size: 9px; /* Adjusted size */
    letter-spacing: 0.5px;
  }
  .toggle-label.on {
    left: 45%;
    transform: translateX(-50%);
    opacity: 0;
  }
  .toggle-label.off {
    left: 58%;
    transform: translateX(-50%);
    opacity: 1;
  }
  input:checked + .slider-text {
    background-color: #2ecc71; /* Staff */
  }
  input:checked + .slider-text:before {
    transform: translateX(60px);
  }
  input:checked + .slider-text .on {
    opacity: 1;
  }
  input:checked + .slider-text .off {
    opacity: 0;
  }
</style>
{% endblock %}
{% block content %}
<div class="col-lg-10 col-md-9 col-sm-9 page-col">
  <h2 class="p-4">👤 Staff Details</h2>
  <div class="add-product">
    <div class="row">
      <div class="col-lg-9">
        <div class="search-div p-4">
          <form action="{% url 'staff' %}" method="get" style="width: 100%; display: flex; gap: 10px;">
            {% csrf_token %}
              <label for="staff-search" class="visually-hidden">Search staff</label>
              <input type="text" id="staff-search" class="search-input" name="search" style="width:47%;" placeholder="🔍 Search staff..." autocomplete="off">
            <div style="width: 30%;">
              <input type="date" name="date" id="date" class="form-control">
              <label for="date" style="font-size: 12px;">Login/Join Date</label>
            </div>
            <button type="submit" class="btn btn-success btn-sm" style="width:16%;margin-top: 0;height:40px;color:white;background-color: #1d4876;">Search</button>
          </form>
        </div>
      </div>
      <div class="col-lg-3">
        <div class="button p-4" style="float: right;">
          <a href="{% url 'add_staff' %}" class="btn text-white" style="background-color: #345578; border-radius: 8px; padding: 8px 16px; font-size: 13px;">Add Staff</a>
        </div>
      </div>
    </div>
  </div>
  {% if users %}
  <div class="table-div">
    <div class="table-responsive">
      <table class="table table-hover table-bordered">
        <thead>
          <tr>
            <th>#</th>
            <th class="text-nowrap">First Name</th>
            <th class="text-nowrap">Last Name</th>
            <th class="text-nowrap">Email</th>
            <th class="text-nowrap">Joined</th>
            <th class="text-nowrap">Last login</th>
            <th class="text-nowrap">Staff</th>
            <th colspan="2" class="text-nowrap">Actions</th>
          </tr>
        </thead>
        <tbody class="table-group-divider">
          {% for user in users %}
          <tr>
            <td>{{ forloop.counter }}</td>
            <td>{{ user.first_name }}</td>
            <td>{{ user.last_name }}</td>
            <td>{{ user.email }}</td>
            <td>{{ user.date_joined }}</td>
            <td>{{ user.last_login }}</td>
            <td>{{ user.is_staff }}</td>
            <td>
              <form method="post" action="{% url 'activate_staff' user.id %}">
                {% csrf_token %}
                <label class="switch-with-text">
                  <input type="checkbox" onchange="this.form.submit()" {% if user.is_staff %}checked{% endif %}>
                  <span class="slider-text">
                    <span class="toggle-label on">Staff</span>
                    <span class="toggle-label off">NoStaff</span>
                  </span>
                </label>
              </form>
            </td>
            <td>
              <div class="dropdown">
                <button class="btn btn-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                  Actions
                </button>
                <ul class="dropdown-menu">
                  <li><a class="dropdown-item" href="{% url 'view_staff' user.id %}">View</a></li>
                  <li><a class="dropdown-item" href="{% url 'update_staff' user.id %}">Edit</a></li>
                  <li><a class="dropdown-item" href="{% url 'delete_staff' user.id %}"  onclick="return confirm('Are you sure you want to delete this staff?');" >Delete</a></li>
                </ul>
              </div>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
  {% else %}
  <div class="else">
    <div class="p-4 text-center text-box">
      <h4>No user found!</h4>
    </div>
  </div>
  {% endif %}
</div>
{% endblock %}
