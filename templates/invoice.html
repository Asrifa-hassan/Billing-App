{% extends 'navbar.html' %}
{% load static %}
{% block title %}Invoice List{% endblock %}
{% block link %}
<link rel="stylesheet" href="{% static 'css/product.css' %}">
{% endblock %}
{% block content %}
<div class="col-lg-10 col-md-9 col-sm-9 page-col">
  <div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h3 class="fw-semibold">ðŸ“„ Invoice List</h3>
      <a href="{% url 'create_invoice' %}" class="btn btn-dark rounded-pill px-4 py-2 shadow-sm">Add New</a>
    </div>
    <form action="{% url 'invoice' %}" method="get" class="card p-3 shadow-sm border-0 mb-4">
      {% csrf_token %}
      <div class="row g-2">
        <div class="col-md-5">
          <input type="text" name="search" class="form-control" placeholder="ðŸ” Search invoice..." autocomplete="off">
        </div>
        <div class="col-md-4">
          <input type="date" name="date" class="form-control">
        </div>
        <div class="col-md-3 d-grid">
          <button type="submit"  class="btn btn-dark btn-sm px-4" style="width: 40%; margin-top: 0; height: 40px;">Search</button>
        </div>
      </div>
    </form>
    {% if invoice %}
    <div class="card shadow-sm border-0 rounded-3">
      <div class="table-responsive">
        <table class="table table-hover align-middle mb-0">
          <thead class="table-light">
            <tr>
              <th>#</th>
              <th>Invoice No</th>
              <th>Customer</th>
              <th>Staff</th>
              <th>Date</th>
              <th>Total</th>
              <th>Action</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody>
            {% for invoice in invoices %}
            <tr>
              <td>{{ forloop.counter }}</td>
              <td class="fw-semibold">#INV{{ invoice.id }}</td>
              <td>{{ invoice.customer.fullname }}</td>
              <td>
                {% if not invoice.staff.first_name %}
                  <span class="badge bg-secondary">Admin</span>
                {% else %}
                  {{ invoice.staff.first_name }} {{ invoice.staff.last_name }}
                {% endif %}
              </td>
              <td>{{ invoice.date }}</td>
              <td>â‚¹{{ invoice.grand_total }}</td>
              <td>
                <a href="{% url 'view_invoice' invoice.id %}" class="btn btn-outline-primary btn-sm">View</a>
              </td>
              <td>
                {% if invoice.amount_due == 0 or invoice.amount_due > 0 %}
                  <span class="badge bg-success px-3 py-2">Fully Paid</span>
                {% else %}
                  <span class="badge bg-danger px-3 py-2">Pending</span>
                {% endif %}
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
    {% else %}
    <div class="alert alert-warning text-center mt-4" role="alert">
      ðŸš« No Invoice Found!
    </div>
    {% endif %}
  </div>
</div>
{% endblock %}